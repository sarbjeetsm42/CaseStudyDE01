/* 1) Find the top 20 zip codes(hint: branch_zip)
   by total transaction value for each transac
   tion type */
USE CREDIT_CARD_DB;
SELECT SUM(TRANSACTION_VALUE) AS TOTAL,
CARD.TRANSACTION_TYPE AS TYPE,
LPAD(BRA.BRANCH_ZIP,5,'0') AS ZIP
FROM CDW_SAPP_F_CREDIT_CARD CARD
JOIN CDW_SAPP_D_BRANCH BRA
ON (CARD.BRANCH_CODE=BRA.BRANCH_CODE)
GROUP BY CARD.TRANSACTION_TYPE,BRA.BRANCH_ZIP;

/* 2) Find total transaction value
   for each transaction type by
   Quarter in 2018
*/

USE CREDIT_CARD_DB;
SELECT SUM(CARD.TRANSACTION_VALUE) AS TOTAL,
CARD.TRANSACTION_TYPE AS TYPE,
TI.QUARTER AS QUARTER
FROM CDW_SAPP_F_CREDIT_CARD CARD
JOIN CDW_SAPP_D_TIME TI
ON (CARD.TIMEID=TI.TIMEID)
GROUP BY CARD.TRANSACTION_TYPE,TI.QUARTER;
